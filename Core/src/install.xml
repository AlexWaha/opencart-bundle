<?xml version="1.0" encoding="utf-8"?>
<!--
  ~ @author  Alexander Vakhovski (AlexWaha)
  ~ @link    https://alexwaha.com
  ~ @email   support@alexwaha.com
  ~ @license GPLv3
  -->
<modification>
    <name>alexwaha.com - Core</name>
    <code>aw_core_init</code>
    <version>1.0</version>
    <author>AlexWaha</author>
    <link>https://alexwaha.com</link>
    <file path="system/engine/{router,front}.php">
        <operation>
            <search><![CDATA[$this->registry = $registry;]]></search>
            <add position="before"><![CDATA[
                $autoloadFile = DIR_SYSTEM . 'library/Alexwaha/Autoload.php';

                if (is_file($autoloadFile)) {
                    require_once($autoloadFile);

                    new \Alexwaha\Autoload();

                    if (class_exists(\Alexwaha\Init::class)) {
                        new \Alexwaha\Init($registry);
                    } else {
                        trigger_error('Class \Alexwaha\Init not found.', E_USER_ERROR);
                    }
                } else {
                    trigger_error('Autoload file not found: ' . $autoloadFile, E_USER_ERROR);
                }
            ]]></add>
        </operation>
    </file>
</modification>
