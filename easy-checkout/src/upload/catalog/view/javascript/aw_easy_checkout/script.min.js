!function(e){window.AwEasyCheckout=function(t){const n=this;n.controllerPath="index.php?route=extension/aw_easy_checkout/",n.$elem=e("#aw-easy-checkout"),n.options=t,n.$checkoutFields=e("input[type='text'], textarea, input[type='checkbox'], input[type='radio'], select",n.$elem),n.clickSelectors='.cart-list .btn, [id^="button-"]',n.reloadInProgress=!1,n.saveInProgress=!1,n.saveFieldsTimeout=null,n.SELECTORS={FORM_DATA:"input[type='text']:visible, input[type='password']:visible, input[type='hidden'], input[type='checkbox']:checked, .checkout-totals input[type='checkbox']:checked, input[type='radio']:checked, textarea:visible, select:visible",SAVE_FIELDS_DATA:"input[type='text']:not([id*='input_item_quantity_']):visible, input[type='hidden'], input[type='checkbox']:checked, input[type='radio']:checked, textarea:visible, select:visible",SHIPPING_COUNTRY:"select[name='shipping_country_id']",PAYMENT_COUNTRY:"select[name='payment_country_id']",SHIPPING_ZONE:"select[name='shipping_zone_id']",PAYMENT_ZONE:"select[name='payment_zone_id']",PHONE_INPUT:"#input-telephone",TELEPHONE_INPUT:"input[name='telephone']",COUPON_INPUT:"input[name='coupon']",VOUCHER_INPUT:"input[name='voucher']",REWARD_INPUT:"input[name='reward']",COUPON_ALERT:".cart-coupon .alert",VOUCHER_ALERT:".cart-voucher .alert",COUPON_ALERT_CLONE:".cart-coupon .coupon-voucher-alert",VOUCHER_ALERT_CLONE:".cart-voucher .coupon-voucher-alert",CART_COUPON:".cart-coupon",CART_VOUCHER:".cart-voucher",BLOCK_SHIPPING_ADDRESS:".block_shipping_address",BLOCK_PAYMENT_ADDRESS:".block_payment_address",BLOCK_SHIPPING_METHOD:".block_shipping_method",BLOCK_PAYMENT_METHOD:".block_payment_method",BLOCK_CUSTOMER:".block_customer",BLOCK_CART:".block_cart",BLOCK_COUPON:".block_coupon",BLOCK_VOUCHER:".block_voucher",FREE_SHIPPING_INFO:".free-shipping-info",FREE_SHIPPING_LEFT:".free-shipping-left",FREE_SHIPPING_BAR_FILL:".free-shipping-bar-fill",FREE_SHIPPING_PROGRESS_BAR:".free-shipping-progress-bar",CART_WEIGHT:".cart-weight",CART_LIST:".cart-list",PANEL_GROUP:".panel-group",TABLE_TOTAL:".table_total",CHECKOUT_TOTALS:".checkout-totals",CHECKOUT_ADDRESS_INFO:".checkout-address-info",CHECKOUT_CART_QUANTITY:".checkout-cart-quantity",CHECKOUT_COL_FIX_RIGHT:".checkout-col-fix-right",PAYMENT_ADDRESS_SAME_AS_SHIPPING:"#payment-address-same-as-shipping",CUSTOMER_ADDRESS_SELECT:"#customer-address-select",BUTTON_ORDER:"#button-order",BUTTON_CONFIRM:"#button-confirm",DATE_PICKER:".date",TIME_PICKER:".time",DATETIME_PICKER:".datetime"},n.init=function(){n.response(),n.initSelect2(),n.authorization(),n.attachEventHandlers(),n.saveFields()},n.attachEventHandlers=function(){const t=e(n.SELECTORS.SHIPPING_COUNTRY,n.$elem),o=e(n.SELECTORS.PAYMENT_COUNTRY,n.$elem);let a;t.length>0&&t.trigger("change"),o.length>0&&o.trigger("change"),n.$elem.on("click",n.clickSelectors,function(t){t.preventDefault();const o=e(this);if(o.hasClass("btn")&&o.closest(".cart-list").length>0){const e=o.data("action");"minus"===e||"plus"===e?n.plusMinusQty(o,e):"remove"===e?n.removeProduct(o.data("key")):"remove-voucher"===e&&n.removeVoucher(o.data("key"))}else if(o.attr("id")&&o.attr("id").startsWith("button-")){const e=o.attr("id");"button-coupon"===e?n.handleCouponButtonClick():"button-reward"===e?n.handleRewardButtonClick():"button-voucher"===e?n.handleVoucherButtonClick():"button-order"===e&&n.validateForm()}}),e(document).on("click",".btn-remove-coupon",function(e){e.preventDefault(),n.removeCoupon()}),e(document).on("click",".btn-remove-voucher",function(e){e.preventDefault(),n.removeVoucherCode()}),e(document).on("change",n.$checkoutFields,function(t){const o=e(t.target);["shipping_country_id","shipping_zone_id","shipping_method","shipping_city","shipping_address_1","shipping_address_2","shipping_postcode","shipping_company","payment_country_id","payment_zone_id","payment_method","payment_city","payment_address_1","payment_address_2","payment_postcode","payment_company"].includes(o.attr("name"))||setTimeout(function(){n.saveFields()},200)}),e(document).on("change","#input-customer-group",function(e){e.preventDefault(),n.customerUpdate(),n.paymentUpdate(),n.shippingAddressUpdate()}),e(document).on("change","input[name='register']",function(){n.toggleRegisterForm(e(this))}),e(document).on("change",".checkout-address input, .checkout-address select, .checkout-address textarea, .checkout-address input[type=\"radio\"], input[name='shipping_method'], input[name='payment_method']",function(t){if("payment_address_same_as_shipping"!==this.name)if(t.preventDefault(),n.saveFields(),"shipping_country_id"===this.name||"payment_country_id"===this.name)if("shipping_country_id"===this.name){e(n.SELECTORS.SHIPPING_ZONE,n.$elem).val(""),n.getShippingZones(this.value),e(n.SELECTORS.TELEPHONE_INPUT,n.$elem).val("");const t=e(this).find("option:selected"),o=t.data("iso")||t.attr("data-iso");n.updatePhoneMaskByCountry(o)}else"payment_country_id"===this.name&&(e(n.SELECTORS.PAYMENT_ZONE,n.$elem).val(""),n.getPaymentZones(this.value));else"payment_method"===this.name?(e("#aw-payment-validation-block").remove(),e(n.SELECTORS.BUTTON_ORDER,n.$elem).show(),setTimeout(function(){n.reload()},100)):"shipping_city"===this.name||"shipping_address_1"===this.name?setTimeout(function(){n.shippingUpdate(),n.updateTotals()},100):("payment_city"===this.name||this.name,setTimeout(function(){n.reload()},100))}),e(document).on("input",".cart-item-price-quantity .form-control",function(){const e=this;clearTimeout(a),a=setTimeout(function(){n.validateQty(e)},600)}),n.initMaskPhone(),n.initDateTimePicker(),n.initPaymentAddressToggle(),n.initCustomerAddressSelector(),n.initFieldErrorRemoval()},n.validateForm=function(){let t=e("input[type='text']:visible, input[type='date']:visible, input[type='datetime-local']:visible, input[type='time']:visible, input[type='password']:visible, input[type='hidden'], input[type='checkbox']:checked, .checkout-totals input[type='checkbox']:checked, input[type='radio']:checked, textarea:visible, select:visible",n.$elem).serialize();t+="&_shipping_method="+e("input[name='shipping_method']:checked",n.$elem).prop("title")+"&_payment_method="+e("input[name='payment_method']:checked",n.$elem).prop("title"),e.ajax({url:n.controllerPath+"validation",type:"post",data:t,dataType:"json",beforeSend:function(){e(".alert-danger").remove(),n.loading(!0)},success:function(t){if(e(".alert:not(.alert-danger),.text-error,.text-danger").remove(),e(".form-group").removeClass("has-error"),t.error){n.loading(!1);for(let n in t.error){const o=n.includes("custom_field")?"#input-"+n.replaceAll("_","-"):"#input-"+n;let a=e(o);if(a.length||(a=e('[name="'+n+'"]')),a.length&&a.closest(".form-group").length)if(a.closest(".form-group").addClass("has-error"),"agree"===n)a.parent().after('<div class="text-danger">'+t.error[n]+"</div>");else{const e=a.closest(".input-group");e.length?e.after('<div class="text-danger">'+t.error[n]+"</div>"):a.after('<div class="text-danger">'+t.error[n]+"</div>")}}const o=e(".form-group.has-error, .checkout-agree.has-error").first();o.length>0&&e("html, body").animate({scrollTop:o.offset().top-120},"slow")}if(t.warning){const e='<div class="alert alert-danger validation-alert"><i class="aw-icon aw-icon-error"></i> '+t.warning+'<button type="button" class="close" data-dismiss="alert"><i class="aw-icon aw-icon-close"></i></button></div>';n.$elem.prepend(e)}const o=t.success&&t.success.payment||t.payment;if(o){e(n.SELECTORS.BUTTON_ORDER,n.$elem).hide(),e("#aw-payment-validation-block").remove();const t='<div id="aw-payment-validation-block">'+o+"</div>";n.$elem.after(t);const a=e("#aw-payment-validation-block"),i=a.find(n.SELECTORS.BUTTON_CONFIRM);if(i.length){i.on("click",function(){e(document).ajaxComplete(function(){setTimeout(function(){n.loading(!1)},300)})});if(1==e('input[name="payment_method"]:checked',n.$elem).data("auto-confirm"))i.trigger("click");else{const t=e("header").outerHeight()||0;e("html, body").animate({scrollTop:a.offset().top-t-50},250),n.loading(!1)}}else n.loading(!1)}},error:function(e,t,o){alert(o+"\r\n"+e.statusText+"\r\n"+e.responseText),n.loading(!1)}})},n.reload=function(){if(n.reloadInProgress)return;n.reloadInProgress=!0;const t={};e(n.SELECTORS.SAVE_FIELDS_DATA,n.$elem).each(function(){const n=e(this),o=n.attr("name");o&&(n.is(":checkbox")||n.is(":radio")?t[o]=n.is(":checked"):t[o]=n.val())});const o=e(n.SELECTORS.FORM_DATA,n.$elem).serialize();e.ajax({url:n.controllerPath+"reload",type:"post",data:o,dataType:"json",cache:!1,global:!1,beforeSend:function(){e(".alert-danger").not(".coupon-voucher-alert").remove(),n.loading(!0)},complete:function(){n.loading(!1),n.reloadInProgress=!1,e(n.SELECTORS.SAVE_FIELDS_DATA,n.$elem).each(function(){const o=e(this),a=o.attr("name");o.is(n.SELECTORS.PAYMENT_ADDRESS_SAME_AS_SHIPPING)||a&&t.hasOwnProperty(a)&&(o.is(":checkbox")||o.is(":radio")?o.prop("checked",t[a]):void 0!==t[a]&&null!==t[a]&&o.val(t[a]))})},success:function(t){if(t.redirect)location=t.redirect;else{for(let o in t)switch(o){case"shipping_method":const o=e(n.SELECTORS.BLOCK_SHIPPING_METHOD,n.$elem);t.shipping_method?o.html(t.shipping_method):o.html("");break;case"shipping_address":const a=e(n.SELECTORS.BLOCK_SHIPPING_ADDRESS,n.$elem);if(e(t.shipping_address).find(n.SELECTORS.CHECKOUT_ADDRESS_INFO).children().length>0){const e=a.find(n.SELECTORS.PAYMENT_ADDRESS_SAME_AS_SHIPPING).closest(".form-group"),o=e.length?e[0].outerHTML:"";a.html(t.shipping_address),a.show(),o&&!a.find(n.SELECTORS.PAYMENT_ADDRESS_SAME_AS_SHIPPING).length&&a.find(n.SELECTORS.CHECKOUT_ADDRESS_INFO).append(o)}else a.find(n.SELECTORS.CHECKOUT_ADDRESS_INFO).empty(),a.hide();"function"==typeof n.initSelect2&&n.initSelect2(),"function"==typeof n.initPaymentAddressToggle&&n.initPaymentAddressToggle(),"function"==typeof n.initCustomerAddressSelector&&n.initCustomerAddressSelector();break;case"payment_address":const i=e(n.SELECTORS.BLOCK_PAYMENT_ADDRESS,n.$elem),s=e(n.SELECTORS.PAYMENT_ADDRESS_SAME_AS_SHIPPING,n.$elem),c=s.length&&s.is(":checked");e(t.payment_address).find(n.SELECTORS.CHECKOUT_ADDRESS_INFO).children().length>0?(i.html(t.payment_address),c?i.slideUp(300):i.slideDown(300)):(i.find(n.SELECTORS.CHECKOUT_ADDRESS_INFO).empty(),i.slideUp(300)),"function"==typeof n.initSelect2&&n.initSelect2();break;case"payment_method":""!==t.payment_method&&e(n.SELECTORS.BLOCK_PAYMENT_METHOD,n.$elem).html(t.payment_method);break;case"customer":e(n.SELECTORS.BLOCK_CUSTOMER,n.$elem).html(t.customer),n.initMaskPhone();break;case"cart":e(n.SELECTORS.BLOCK_CART,n.$elem).html(t.cart),n.options.load_script&&n.options.load_script.trim()&&new Function(n.options.load_script)();break;case"coupon":const r=e(n.SELECTORS.COUPON_ALERT_CLONE,n.$elem).clone();e(n.SELECTORS.BLOCK_COUPON,n.$elem).html(t.coupon),r.length&&e(n.SELECTORS.CART_COUPON,n.$elem).prepend(r);break;case"voucher":const l=e(n.SELECTORS.VOUCHER_ALERT_CLONE,n.$elem).clone();e(n.SELECTORS.BLOCK_VOUCHER,n.$elem).html(t.voucher),l.length&&e(n.SELECTORS.CART_VOUCHER,n.$elem).prepend(l);break;case"totals":const d=e(n.SELECTORS.CART_WEIGHT,n.$elem);d.length&&d.html(e(t.totals).find(n.SELECTORS.CART_WEIGHT).html());const p=e(t.totals).find(n.SELECTORS.FREE_SHIPPING_LEFT).html();let u=null;if(p?u=e(t.totals).find(".free-shipping-inner").attr("data-fsl-width")||null:e(n.SELECTORS.FREE_SHIPPING_LEFT,n.$elem).remove(),u){if(e(n.SELECTORS.FREE_SHIPPING_LEFT,n.$elem).length){const t=parseFloat(u),o=e(n.SELECTORS.FREE_SHIPPING_BAR_FILL,n.$elem),a=e(n.SELECTORS.FREE_SHIPPING_INFO,n.$elem),i=e(n.SELECTORS.FREE_SHIPPING_PROGRESS_BAR,n.$elem);o.css({width:t+"%"}),a.html(e(p).find(n.SELECTORS.FREE_SHIPPING_INFO).html()),100===t?(i.addClass("hidden"),a.addClass("active-free-shipping")):(i.removeClass("hidden"),a.removeClass("active-free-shipping"))}else if(p){e(n.SELECTORS.CHECKOUT_TOTALS,n.$elem).prepend('<div class="free-shipping-left">'+p+"</div>")}}e(n.SELECTORS.TABLE_TOTAL,n.$elem).html(e(t.totals).find(n.SELECTORS.TABLE_TOTAL).html());break;case"errors":if(t.errors&&Object.keys(t.errors).length>0)e(".alert-danger").remove(),e.each(t.errors,function(e,t){let o='<div class="alert alert-danger '+e+'">';o+='<i class="aw-icon aw-icon-error"></i>'+t+'<button type="button" class="close" data-dismiss="alert"><i class="aw-icon aw-icon-close"></i></button>',o+="</div>",n.$elem.before(o)});else{const t=e(".alert-danger");t.length&&t.remove()}}n.initDateTimePicker()}}})},n.shippingUpdate=function(){const t=e(n.SELECTORS.FORM_DATA,n.$elem).serialize();e.ajax({url:n.controllerPath+"shipping_method",type:"post",data:t,dataType:"html",cache:!1,beforeSend:function(){n.loading(!0)},complete:function(){n.loading(!1)},success:function(t){const o=e(n.SELECTORS.BLOCK_SHIPPING_METHOD,n.$elem);t.length?o.html(t):o.html("")}})},n.paymentUpdate=function(){const t=e(n.SELECTORS.FORM_DATA,n.$elem).serialize();e.ajax({url:n.controllerPath+"payment_method",type:"post",data:t,dataType:"html",cache:!1,success:function(t){e(n.SELECTORS.BLOCK_PAYMENT_METHOD,n.$elem).html(t)}})},n.updateCart=function(){const t=e(n.SELECTORS.FORM_DATA,n.$elem);e.ajax({url:n.controllerPath+"cart",type:"post",data:t,dataType:"html",cache:!1,success:function(t){const o=e(t);e(n.SELECTORS.TABLE_TOTAL,n.$elem).html(o.find(n.SELECTORS.TABLE_TOTAL).html()),e(n.SELECTORS.CART_LIST,n.$elem).html(o.find(n.SELECTORS.CART_LIST).html()),e(n.SELECTORS.PANEL_GROUP,n.$elem).html(o.find(n.SELECTORS.PANEL_GROUP).html()),n.options.load_script&&n.options.load_script.trim()&&new Function(n.options.load_script)()}})},n.updateTotals=function(){const t=e(n.SELECTORS.FORM_DATA,n.$elem);e.ajax({url:n.controllerPath+"cart/getTotals",type:"post",data:t,dataType:"html",cache:!1,success:function(t){const o=e(t),a=e(n.SELECTORS.CART_WEIGHT,n.$elem);a.length&&a.html(o.find(n.SELECTORS.CART_WEIGHT).html()),e(n.SELECTORS.TABLE_TOTAL,n.$elem).html(o.find(n.SELECTORS.TABLE_TOTAL).html())}})},n.shippingAddressUpdate=function(){const t=e(n.SELECTORS.FORM_DATA,n.$elem).serialize();e.ajax({url:n.controllerPath+"shipping_address",type:"post",data:t,dataType:"html",cache:!1,complete:function(){n.loading(!1)},success:function(t){const o=e(n.SELECTORS.BLOCK_SHIPPING_ADDRESS,n.$elem);e(t).find(n.SELECTORS.CHECKOUT_ADDRESS_INFO).children().length>0?(o.html(t),o.removeClass("hidden")):o.addClass("hidden"),n.initDateTimePicker()}}).done(function(){"function"==typeof n.initSelect2&&n.initSelect2(),"function"==typeof n.initCustomerAddressSelector&&n.initCustomerAddressSelector()})},n.customerUpdate=function(){const t=e(n.SELECTORS.FORM_DATA,n.$elem).serialize();e.ajax({url:n.controllerPath+"customer",type:"post",data:t,dataType:"html",cache:!1,beforeSend:function(){n.loading(!0)},complete:function(){n.loading(!1)},success:function(t){e(n.SELECTORS.BLOCK_CUSTOMER,n.$elem).html(t),n.initMaskPhone(),n.initDateTimePicker()}})},n.buildZoneOptionsHtml=function(e,t,n){let o='<option value="">'+n+"</option>";if(e&&""!==e)for(let n=0;n<e.length;n++)o+='<option value="'+e[n].zone_id+'"',e[n].zone_id===t&&(o+=' selected="selected"'),o+=">"+e[n].name+"</option>";return o},n.getShippingZones=function(t){e.ajax({url:n.controllerPath+"country&country_id="+t+"&address_type=shipping",dataType:"json",success:function(t){const o=n.options.lang&&n.options.lang.text_select||"Please Select",a=n.buildZoneOptionsHtml(t.zone,t.active_zone_id,o);e(n.SELECTORS.SHIPPING_ZONE,n.$elem).html(a),n.shippingUpdate()},error:function(e,t,n){alert(n+"\r\n"+e.statusText+"\r\n"+e.responseText)}})},n.getPaymentZones=function(t){e.ajax({url:n.controllerPath+"country&country_id="+t+"&address_type=payment",dataType:"json",success:function(t){const o=n.options.lang&&n.options.lang.text_select||"Please Select",a=n.buildZoneOptionsHtml(t.zone,t.active_zone_id,o);e(n.SELECTORS.PAYMENT_ZONE,n.$elem).html(a),n.reload()},error:function(e,t,n){alert(n+"\r\n"+e.statusText+"\r\n"+e.responseText)}})},n.initMaskPhone=function(){const t=e(n.SELECTORS.PHONE_INPUT,n.$elem);if(t.length){const e=n.options.tel_mask||"";e.length&&(t.attr("placeholder",e),n.phoneMaska=new Maska.MaskInput(t[0],{mask:e}))}},n.updatePhoneMaskByCountry=function(t){const o=e(n.SELECTORS.PHONE_INPUT,n.$elem);if(!o.length)return;n.phoneMaska&&(n.phoneMaska.destroy(),n.phoneMaska=null);const a=n.options.tel_mask||"+### (###) ###-##-##";if(!n.options.country_masks||!t)return o.attr("placeholder",a),void(n.phoneMaska=new Maska.MaskInput(o[0],{mask:a}));const i=n.options.country_masks[t.toUpperCase()];i&&i.mask?(o.attr("placeholder",i.mask),n.phoneMaska=new Maska.MaskInput(o[0],{mask:i.mask})):(o.attr("placeholder",a),n.phoneMaska=new Maska.MaskInput(o[0],{mask:a}))},n.initDateTimePicker=function(){const t=e(n.SELECTORS.DATE_PICKER,n.$elem);t.length&&t.each(function(){const t=e(this);t.data("DateTimePicker")&&t.data("DateTimePicker").destroy(),t.off("dp.change"),t.datetimepicker({pickTime:!1,minDate:new Date}),t.on("dp.change",function(t){const n=e(this).find("input");if(t.date){const e=t.date.format("YYYY-MM-DD");n.val(e),n.attr("value",e)}else n.val(""),n.attr("value","")})});const o=e(n.SELECTORS.TIME_PICKER,n.$elem);o.length&&o.each(function(){const t=e(this);t.data("DateTimePicker")&&t.data("DateTimePicker").destroy(),t.off("dp.change"),t.datetimepicker({pickDate:!1}),t.on("dp.change",function(t){const n=e(this).find("input");if(t.date){const e=t.date.format("HH:mm");n.val(e),n.attr("value",e)}else n.val(""),n.attr("value","")})});const a=e(n.SELECTORS.DATETIME_PICKER,n.$elem);a.length&&a.each(function(){const t=e(this);t.data("DateTimePicker")&&t.data("DateTimePicker").destroy(),t.off("dp.change"),t.datetimepicker({pickDate:!0,pickTime:!0}),t.on("dp.change",function(t){const n=e(this).find("input");if(t.date){const e=t.date.format("YYYY-MM-DD HH:mm");n.val(e),n.attr("value",e)}else n.val(""),n.attr("value","")})})},n.handleCouponButtonClick=function(){const t=e(n.SELECTORS.COUPON_INPUT,n.$elem),o=t.val().trim(),a=e(n.SELECTORS.CART_COUPON,n.$elem);if(""===o){e(n.SELECTORS.COUPON_ALERT,n.$elem).remove();const t=n.options.lang&&n.options.lang.text_coupon_required||"Please enter coupon code";return void a.prepend('<div class="alert alert-danger coupon-voucher-alert"><i class="aw-icon aw-icon-error"></i> '+t+'<button type="button" class="close" data-dismiss="alert"><i class="aw-icon aw-icon-close"></i></button></div>')}e.ajax({url:"index.php?route=extension/total/coupon/coupon",type:"post",data:"coupon="+encodeURIComponent(o),dataType:"json",beforeSend:function(){t.attr("disabled","disabled")},complete:function(){t.removeAttr("disabled")},success:function(t){if(e(n.SELECTORS.COUPON_ALERT,n.$elem).remove(),t.error)a.prepend('<div class="alert alert-danger coupon-voucher-alert"><i class="aw-icon aw-icon-error"></i> '+t.error+'<button type="button" class="close" data-dismiss="alert"><i class="aw-icon aw-icon-close"></i></button></div>');else if(t.success||t.redirect){const e=t.success||n.options.lang&&n.options.lang.text_coupon_success||"Coupon successfully applied";a.prepend('<div class="alert alert-success coupon-voucher-alert"><i class="aw-icon aw-icon-success"></i> '+e+'<button type="button" class="close" data-dismiss="alert"><i class="aw-icon aw-icon-close"></i></button></div>'),n.reload()}}})},n.handleRewardButtonClick=function(){const t=e(n.SELECTORS.REWARD_INPUT,n.$elem);e.ajax({url:"index.php?route=extension/total/reward/reward",type:"post",data:"reward="+encodeURIComponent(t.val()),dataType:"json",beforeSend:function(){t.attr("disabled","disabled")},complete:function(){t.removeAttr("disabled")},success:function(t){e(".alert").remove(),t.error&&e("body").append('<div class="alert alert-danger"><i class="aw-icon aw-icon-error"></i> <div class="text-modal-block">'+t.error+'</div><button type="button" class="close" data-dismiss="alert"></button></div>'),t.success&&e("body").append('<div class="alert alert-success"><i class="aw-icon aw-icon-success"></i><div class="text-modal-block">'+t.success+'</div><button type="button" class="close" data-dismiss="alert"></button></div>'),n.reload()}})},n.handleVoucherButtonClick=function(){const t=e(n.SELECTORS.VOUCHER_INPUT,n.$elem),o=t.val().trim(),a=e(n.SELECTORS.CART_VOUCHER,n.$elem);if(""===o){e(n.SELECTORS.VOUCHER_ALERT,n.$elem).remove();const t=n.options.lang&&n.options.lang.text_voucher_required||"Please enter voucher code";return void a.prepend('<div class="alert alert-danger coupon-voucher-alert"><i class="aw-icon aw-icon-error"></i> '+t+'<button type="button" class="close" data-dismiss="alert"><i class="aw-icon aw-icon-close"></i></button></div>')}e.ajax({url:"index.php?route=extension/total/voucher/voucher",type:"post",data:"voucher="+encodeURIComponent(o),dataType:"json",beforeSend:function(){t.attr("disabled","disabled")},complete:function(){t.removeAttr("disabled")},success:function(t){if(e(n.SELECTORS.VOUCHER_ALERT,n.$elem).remove(),t.error)a.prepend('<div class="alert alert-danger coupon-voucher-alert"><i class="aw-icon aw-icon-error"></i> '+t.error+'<button type="button" class="close" data-dismiss="alert"><i class="aw-icon aw-icon-close"></i></button></div>');else if(t.success||t.redirect){const e=t.success||n.options.lang&&n.options.lang.text_voucher_success||"Voucher successfully applied";a.prepend('<div class="alert alert-success coupon-voucher-alert"><i class="aw-icon aw-icon-success"></i> '+e+'<button type="button" class="close" data-dismiss="alert"><i class="aw-icon aw-icon-close"></i></button></div>'),n.reload()}}})},n.removeCoupon=function(){e(n.SELECTORS.COUPON_INPUT,n.$elem).val(""),e.ajax({url:n.controllerPath+"coupon_voucher/removeCoupon",type:"post",dataType:"json",success:function(){e(n.SELECTORS.COUPON_ALERT,n.$elem).remove(),n.reload()}})},n.removeVoucherCode=function(){e(n.SELECTORS.VOUCHER_INPUT,n.$elem).val(""),e.ajax({url:n.controllerPath+"coupon_voucher/removeVoucher",type:"post",dataType:"json",success:function(){e(n.SELECTORS.VOUCHER_ALERT,n.$elem).remove(),n.reload()}})},n.plusMinusQty=function(e,t){let o=e.closest(n.SELECTORS.CHECKOUT_CART_QUANTITY),a=o.find("input").data("key"),i=parseFloat(o.find("input").data("minimum"));i=i<1?1:i;let s=parseFloat(o.find("input").val().replace(/\D/g,""));0===s?s=i:"plus"===t?s+=i:"minus"===t&&(s<=i?s=i:s-=i),o.find("input").val(s),n.updateQty(a,s,i)},n.ajaxCartRequest=function(t,o){e.ajax({url:n.controllerPath+t,type:"post",data:o,dataType:"json",global:!1,beforeSend:function(){n.loading(!0)},complete:function(){n.loading(!1)},success:function(){n.reload()},error:function(e,t,n){alert(n+"\r\n"+e.statusText+"\r\n"+e.responseText)}})},n.updateQty=function(e,t,o=1){t>=o&&n.ajaxCartRequest("cart/editCart","quantity["+e+"]="+t)},n.validateQty=function(t){let o;const a=e(t);let i=a.data("minimum"),s=a.val().trim(),c=a.data("key");/^0/.test(s)?a.val(i):(o=s.replace(/\D/g,""),""===o&&(o=i),"0"===o&&(o=i),o<i&&(o=i),a.val(o)),n.updateQty(c,o,i)},n.removeProduct=function(e){n.ajaxCartRequest("cart/removeFromCart","key="+e)},n.removeVoucher=function(e){n.ajaxCartRequest("cart/removeFromCart","key="+e)},n.saveFields=function(t=!1){if(n.saveFieldsTimeout&&(clearTimeout(n.saveFieldsTimeout),n.saveFieldsTimeout=null),n.saveInProgress||n.reloadInProgress)return;const o=function(){n.saveInProgress=!0,e.ajax({url:n.controllerPath+"reload/save",type:"post",data:e(n.SELECTORS.SAVE_FIELDS_DATA,n.$elem),dataType:"json",cache:!1,global:!1,complete:function(){n.saveInProgress=!1},error:function(e,t,o){n.saveInProgress=!1}})};t?o():n.saveFieldsTimeout=setTimeout(o,100)},n.initSelect2=function(){e(".block_shipping_address, .block_payment_address",n.$elem).find("select[data-type=select2]").each(function(){e(this).select2()})},n.authorization=function(){e(document).on("click",".login",function(t){t.preventDefault(),e.ajax({type:"get",url:n.controllerPath+"main/login",beforeSend:function(){n.loading(!0)},complete:function(){n.loading(!1)},success:function(t){e("html body").append('<div id="login-form-popup" class="modal fade" role="dialog">'+t+"</div>"),e("#login-form-popup").modal("show"),n.validateLogin(),e(document).on("hide.bs.modal","#login-form-popup.modal.fade",function(){e("#login-form-popup").remove()})}})})},n.validateLogin=function(){e(document).on("click","#button-login-popup",function(t){t.preventDefault(),e.ajax({url:n.controllerPath+"validation/validateLogin",type:"post",data:e("#aw-checkout-login input"),dataType:"json",beforeSend:function(){n.loading(!0)},complete:function(){n.loading(!1)},success:function(t){const o=e("#login-error-container"),a=e(".text-danger"),i=e("#input-email-popup"),s=e("#input-password-popup");if(o.empty(),a.remove(),i.removeClass("error"),s.removeClass("error"),t.isLogged&&(window.location.href="index.php?route=account/account"),t.error){let e="";t.error.warning&&(e+='<div class="alert alert-danger"><i class="aw-icon aw-icon-error"></i> '+t.error.warning+'<button type="button" class="close" data-dismiss="alert"><i class="aw-icon aw-icon-close"></i></button></div>'),t.error.email&&i.addClass("error").after('<div class="text-danger">'+t.error.email+"</div>"),t.error.password&&s.addClass("error").after('<div class="text-danger">'+t.error.password+"</div>"),e&&o.html(e)}t.success&&(e("#login-form-popup").modal("hide"),n.$elem.prepend('<div class="alert alert-success"><i class="aw-icon aw-icon-success"></i> '+t.success+'<button type="button" class="close" data-dismiss="alert"><i class="aw-icon aw-icon-close"></i></button></div>'),setTimeout(function(){location.reload()},3e3))},error:function(e,t,n){alert(n+"\r\n"+e.statusText+"\r\n"+e.responseText)}})})},n.addTopCartRight=function(){if(n.viewport().width>991)if(e("header").hasClass("fix-header")){const t=e("header").outerHeight()||0;e(n.SELECTORS.CHECKOUT_COL_FIX_RIGHT).css("top",t+30)}else e(n.SELECTORS.CHECKOUT_COL_FIX_RIGHT).css("top",30);else e(n.SELECTORS.CHECKOUT_COL_FIX_RIGHT).css("top",0)},n.response=function(){let t,o;o=e(window).width(),n.addTopCartRight(),this.resizer=function(){e(window).width()!==o&&(window.clearTimeout(t),t=window.setTimeout(function(){o=e(window).width(),n.addTopCartRight()},200))},e(window).resize(this.resizer)},n.loading=function(t){const n=e(".aw-loading");t?(n.length||e("body").append('<div class="aw-loading"><div class="aw-loading-spinner"></div></div>'),n.show()):n.hide()},n.toggleRegisterForm=function(t){const n=e("#register-form");t.length&&n.length&&(n.removeClass("hidden").css("display",""),t.is(":checked")?n.show():n.hide(),t.off("change").on("change",function(){e(this).is(":checked")?n.slideDown(300):n.slideUp(300)}))},n.initPaymentAddressToggle=function(){const t=e(n.SELECTORS.PAYMENT_ADDRESS_SAME_AS_SHIPPING,n.$elem),o=e(n.SELECTORS.BLOCK_PAYMENT_ADDRESS,n.$elem);t.length&&o.length&&(o.removeClass("hidden").css("display",""),t.is(":checked")?o.hide():o.show(),t.off("change").on("change",function(){if(e(this).is(":checked"))o.slideUp(300,function(){n.saveFields(!0)});else{0===o.find(n.SELECTORS.CHECKOUT_ADDRESS_INFO).children().length?(o.show(),n.saveFields(!0),setTimeout(function(){n.reload()},100)):o.slideDown(300,function(){n.saveFields(!0)})}}))},n.initCustomerAddressSelector=function(){const t=e(n.SELECTORS.CUSTOMER_ADDRESS_SELECT,n.$elem);t.length&&t.off("change").on("change",function(){const t=e(this).val();t&&e.ajax({url:n.controllerPath+"reload/changeAddress",type:"post",data:"address_id="+t,dataType:"json",beforeSend:function(){n.loading(!0)},complete:function(){n.loading(!1)},success:function(e){e.success&&n.reload()},error:function(e,t,n){alert(n+"\r\n"+e.statusText+"\r\n"+e.responseText)}})})},n.viewport=function(){let e=window,t="inner";return"innerWidth"in window||(t="client",e=document.documentElement||document.body),{width:e[t+"Width"],height:e[t+"Height"]}},n.initFieldErrorRemoval=function(){e(document).on("input change","input, select, textarea",n.$elem,function(){const t=e(this),n=t.closest(".form-group");if(n.hasClass("has-error")){n.removeClass("has-error");const e=t.closest(".input-group");e.length?e.next(".text-danger").remove():(t.next(".text-danger").remove(),t.siblings(".text-danger").remove())}}),e(document).on("change",'input[type="checkbox"], input[type="radio"]',n.$elem,function(){const t=e(this),n=t.closest(".form-group");n.hasClass("has-error")&&(n.removeClass("has-error"),t.parent().next(".text-danger").remove())})}}}(jQuery);